<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>828 Weather Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  :root {
    --bg:#0f172a;
    --card:#1e293b;
    --accent:#38bdf8;
    --red:#ef4444;
    --orange:#f97316;
    --green:#22c55e;
    --text:#f1f5f9;
  }
  body {
    margin:0;
    font-family:'Inter',sans-serif;
    background:linear-gradient(180deg,#0f172a,#020617);
    color:var(--text);
    padding:20px;
  }
  h1 {
    text-align:center;
    font-weight:800;
    letter-spacing:2px;
  }
  .grid {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
    gap:20px;
    margin-top:20px;
  }
  .card {
    background:var(--card);
    padding:20px;
    border-radius:16px;
    box-shadow:0 10px 30px rgba(0,0,0,.4);
  }
  .temp {
    font-size:48px;
    font-weight:800;
  }
  .pill {
    margin-top:10px;
    padding:8px 12px;
    border-radius:999px;
    display:inline-block;
    font-weight:600;
  }
  canvas {
    margin-top:20px;
  }
  a.button {
    display:inline-block;
    margin-top:10px;
    padding:8px 14px;
    background:var(--accent);
    color:black;
    text-decoration:none;
    border-radius:8px;
    font-weight:600;
  }
</style>
</head>
<body>

<h1>828 WEATHER</h1>

<div class="grid">
  <div class="card">
    <div class="temp" id="local-temp">--°F</div>
    <div id="comfort-report">Loading comfort...</div>
    <div id="wind-status"></div>
    <div id="main-alert" class="pill" style="display:none"></div>
  </div>

  <div class="card">
    <h3>Next 12 Hours</h3>
    <canvas id="hourlyChart"></canvas>
  </div>

  <div class="card">
    <h3>Radar</h3>
    <a class="button" target="_blank" href="https://radar.weather.gov/">Open NWS Radar</a>
  </div>
</div>

<script>
const lat = 35.5951;
const lon = -82.5515;

async function updateWeather() {
  try {
    const res = await fetch(
      `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,dewpoint_2m,wind_gusts_10m&hourly=temperature_2m,precipitation_probability&temperature_unit=fahrenheit&wind_speed_unit=mph&timezone=America/New_York`
    );

    const data = await res.json();

    const temp = Math.round(data.current.temperature_2m);
    const dew = Math.round(data.current.dewpoint_2m);
    const gust = Math.round(data.current.wind_gusts_10m);

    document.getElementById('local-temp').innerText = temp + "°F";

    // Comfort logic
    const comfort = document.getElementById('comfort-report');
    if (dew < 50) comfort.innerText = "Crisp";
    else if (dew <= 60) comfort.innerText = "Pleasant";
    else comfort.innerText = "Humid";

    // Wind logic
    const status = document.getElementById('wind-status');
    const pill = document.getElementById('main-alert');

    if (gust >= 40) {
      status.innerText = "HIGH IMPACT WIND";
      pill.style.display = 'inline-block';
      pill.style.background = 'var(--red)';
      pill.innerText = "Stay indoors; falling limbs possible.";
    } else if (gust >= 30) {
      status.innerText = "BIN ALERT";
      pill.style.display = 'inline-block';
      pill.style.background = 'var(--orange)';
      pill.innerText = "Secure garbage bins.";
    } else {
      status.innerText = "Calm (" + gust + " mph gust)";
      pill.style.display = 'none';
    }

    buildChart(data.hourly);

  } catch (err) {
    console.error(err);
  }
}

function buildChart(hourly) {
  const ctx = document.getElementById('hourlyChart');

  const next12Temps = hourly.temperature_2m.slice(0,12);
  const next12Times = hourly.time.slice(0,12).map(t => t.split('T')[1].slice(0,5));

  new Chart(ctx, {
    type: 'line',
    data: {
      labels: next12Times,
      datasets: [{
        label: 'Temp °F',
        data: next12Temps,
        tension: 0.4,
        fill: true
      }]
    },
    options: {
      plugins:{legend:{display:false}},
      scales:{
        y:{ticks:{color:'#f1f5f9'}},
        x:{ticks:{color:'#f1f5f9'}}
      }
    }
  });
}

updateWeather();
</script>

</body>
</html>
